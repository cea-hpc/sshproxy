---
debug: true
log: "/var/log/sshproxy/{user}.log"
check_interval: "2m30s"
error_banner: "an error banner"
dump: "/var/lib/sshproxy/dumps/{user}/{time}-{sid}.dump"
dump_limit_size: 10
dump_limit_window: "2m31s"
log_stats_interval: "2m32s"
etcd_stats_interval: "2m33s"
translate_commands:
  "internal-sftp":
    ssh_args:
      - "-oForwardX11=no"
      - "-oForwardAgent=no"
      - "-oPermitLocalCommand=no"
      - "-oClearAllForwardings=yes"
      - "-oProtocol=2"
      - "-s"
    command: "sftp"
    disable_dump: true
etcd:
    endpoints:
        - "host1:port1"
        - "host2:port2"
    tls:
        cafile: "ca.pem"
        keyfile: "cert.key"
        certfile: "cert.pem"
    username: "test"
    password: "pass"
    keyttl: 5
    mandatory: true
environment:
    XAUTHORITY: /tmp/.Xauthority_{user}
max_connections_per_user: 50
dest: ["host5:4222"]
command_must_match: true
etcd_keyttl: 3600
overrides:
    - match:
        - sources: ['127.0.0.[1-3]']
      environment:
          XAUTHORITY: /dev/shm/.Xauthority_{user}
    - match:
        - users: [alice, bob]
          sources: [127.0.0.1]
          groups: [foo]
      debug: true
      log: /tmp/sshproxy-foo/{user}.log
      check_interval: "2m"
      error_banner: "an other error banner"
      dump: /tmp/sshproxy-{user}-{time}.dump
      dump_limit_size: 20
      dump_limit_window: "3m"
      etcd:
        endpoints:
            - "host2"
        tls:
            cafile: "ca2.pem"
            keyfile: "cert2.key"
            certfile: "cert2.pem"
        username: "test2"
        password: "pass2"
        keyttl: 2
        mandatory: false
      etcd_stats_interval: "4m"
      log_stats_interval: "5m"
      blocking_command: "/a/blocking/command"
      bg_command: "/a/background/command"
      ssh:
          exe: sshhhhh
          args: ["-vvv", "-Y"]
      translate_commands:
        "internal-sftp":
          ssh_args:
            - "-s"
          command: "anothercommand"
        "acommand":
          command: "something"
          disable_dump: true
      environment:
          ENV1: /tmp/env
      service: service5
      dest: ["server1:12345"]
      route_select: bandwidth
      mode: balanced
      force_command: acommand
      command_must_match: false
      etcd_keyttl: 0
      max_connections_per_user: 0
    - match:
        - groups: [bar]
          groups: [baz]
      debug: false
      dest: ["192.168.0.[1-9]"]
